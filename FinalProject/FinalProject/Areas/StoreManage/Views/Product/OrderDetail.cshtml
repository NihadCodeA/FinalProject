@model List<OrderItem>
@{
    Order order = ViewData["Order"] as Order;
}
<main class="main-content-wrapper">
    <!-- container -->
    <div class="container">
        <!-- row -->
        <div class="row mb-8">
            <div class="col-md-12">
                <div class="d-md-flex justify-content-between align-items-center">
                    <div>
                        <!-- page header -->
                        <h2>Order #@order.Id</h2>
                    </div>
                    <!-- button -->
                    <div>
                        <a asp-area="storemanage" asp-controller="product" asp-action="orders" asp-route-page="1" class="btn btn-primary">Back to all orders</a>
                    </div>

                </div>
            </div>
        </div>
        <!-- row -->
        <div class="row ">
            <div class="col-xl-12 col-12 mb-5">
                <!-- card -->
                <div class="card h-100 card-lg">
                    <div class="card-body p-6">
                        <div class="mt-8">
                            <div class="row">
                                <!-- address -->
                                <div class="col-lg-4 col-md-4 col-12">
                                    <div class="mb-6">
                                        <h6>Customer Details</h6>
                                        <p class="mb-1 lh-lg">
                                          @order.FullName<br>
                                            @order.Email<br>
                                            @order.PhoneNumber
                                        </p>
                                    </div>
                                </div>
                                <!-- address -->
                                <div class="col-lg-4 col-md-4 col-12">
                                    <div class="mb-6">
                                        <h6>Order Details</h6>
                                        <p class="mb-1 lh-lg">
                                            Order ID: <span class="text-dark">#@order.Id</span><br>
                                            Order Date: <span class="text-dark">@(DateTime.Parse($"{order.CreatedTime}").ToString("MMMM dd yyyy HH:mm"))</span><br>
                                            Order Total: <span class="text-dark">$@(order.TotalPrice.ToString("0.00"))</span>
                                        </p>
                                    </div>
                                </div>
                                <!-- address -->
                                <div class="col-12">
                                    <div class="mb-6">
                                        <h6>Shipping Address</h6>
                                        <p class="mb-1 lh-lg">
                                            Country : <span class="text-dark">@order.Country</span><br>
                                            City : <span class="text-dark">@order.City</span><br>
                                            Address 1 : <span class="text-dark">@order.Address1</span> <br>
                                            @if(order.Address2 != null)
                                            {
                                            <span>Address 2 </span>
                                            <span class="text-dark">: @order.Address1</span> <br>
                                            }
                                            Other notes : <span class="text-dark">@order.OtherNotes</span>
                                        </p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-12">
                            <div class="table-responsive">
                                <!-- Table -->
                                <table class="table mb-0 text-nowrap table-centered">
                                    <!-- Table Head -->
                                    <thead class="bg-light">
                                        <tr>
                                            <th>Products</th>
                                            <th>Price</th>
                                            <th>Discount price</th>
                                            <th>Quantity</th>
                                            <th>Total</th>
                                        </tr>
                                    </thead>
                                    <!-- tbody -->
                                    <tbody>
                                        @foreach(OrderItem orderItem in Model){
                                            <tr>
                                                <td>
                                                        <div class="d-flex align-items-center">
                                                            <div>
                                                                <img src="~/uploads/products/@orderItem.Product.ProductImages.FirstOrDefault(x=>x.IsPoster==true).Image" alt=""
                                                                 class="icon-shape icon-lg">
                                                            </div>
                                                            <div class="ms-lg-4 mt-2 mt-lg-0">
                                                                <h5 class="mb-0 h6">
                                                                    @orderItem.Product.Name
                                                                </h5>

                                                            </div>
                                                        </div>
                                                </td>
                                                <td><span class="text-body">$@(orderItem.Product.SalePrice)</span></td>
                                                <td><span class="text-body">$@((orderItem.Product.SalePrice * (1 - orderItem.Product.DiscountPercentage / 100)).ToString("0.00"))</span></td>
                                                <td>@orderItem.Count</td>
                                                <td>$@(((orderItem.Product.SalePrice * (1 - orderItem.Product.DiscountPercentage / 100)) * orderItem.Count).ToString("0.00"))</td>
                                            </tr>
                                        }

                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>

            </div>

        </div>

    </div>

</main>