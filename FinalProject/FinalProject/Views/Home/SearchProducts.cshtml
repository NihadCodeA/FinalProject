@model PaginatedList<Product>
@{
    string categoryAz = ViewData["CategoryNameAz"] as string;
    string categoryEn = ViewData["CategoryNameEn"] as string;
    int productCount = (int)ViewData["productCount"];
    string language = ViewData["Language"] as string;
    List<Category> categories = ViewBag.Categories as List<Category>;
}
<main>
  <!-- section -->
  <div class=" mt-8 mb-lg-14 mb-8">
    <!-- container -->
    <div class="container">
      <!-- row -->
      <div class="row gx-10">
        <!-- col -->
        <aside class="col-lg-3 col-md-4 mb-6 mb-md-0">
          <div class="offcanvas offcanvas-start offcanvas-collapse w-md-50 " tabindex="-1" id="offcanvasCategory" aria-labelledby="offcanvasCategoryLabel">

            <div class="offcanvas-header d-lg-none">
              <h5 class="offcanvas-title" id="offcanvasCategoryLabel">Filter</h5>
              <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
            </div>
            <div class="offcanvas-body ps-lg-2 pt-lg-0">
            <div class="mb-8">
            <!-- title -->
            <h5 class="mb-3">Categories</h5>
            <!-- nav -->
            <ul class="nav nav-category" id="categoryCollapseMenu">
                                    @foreach (var item in categories)
                 {          
                          <li class="nav-item border-bottom w-100 collapsed">
                           <a asp-controller="home" asp-action="searchproducts" asp-route-categoryId="@item.Id" asp-route-page="1" class="nav-link">
                                  @(language== "az" ? item.NameAz : item.NameEn) <i class="feather-icon icon-chevron-right"></i>
                               </a>
                          </li>
                  }
             </ul>
          </div>

          <div class="mb-8">

            <h5 class="mb-3">Stores</h5>
            <div class="my-4">
              <!-- input -->
              <input type="search" class="form-control" placeholder="Search by store">
            </div>
            <!-- form check -->
            <div class="form-check mb-2">
              <!-- input -->
              <input class="form-check-input" type="checkbox" value="" id="eGrocery" checked>
              <label class="form-check-label" for="eGrocery">
                E-Grocery
              </label>
            </div>

          </div>
          <div class="mb-8">
            <!-- price -->
            <h5 class="mb-3">Price</h5>
            <div>
              <!-- range -->
              <div id="priceRange" class="mb-3"></div>
              <input placeholder="min" class="form-control"/>
              <input placeholder="max" class="form-control"/>
            </div>



          </div>
          <!-- rating -->
          @*<div class="mb-8">

            <h5 class="mb-3">Rating</h5>
            <div>
              <!-- form check -->
              <div class="form-check mb-2">
                <!-- input -->
                <input class="form-check-input" type="checkbox" value="" id="ratingFive">
                <label class="form-check-label" for="ratingFive">
                  <i class="bi bi-star-fill text-warning"></i>
                  <i class="bi bi-star-fill text-warning "></i>
                  <i class="bi bi-star-fill text-warning "></i>
                  <i class="bi bi-star-fill text-warning "></i>
                  <i class="bi bi-star-fill text-warning "></i>
                </label>
              </div>
              <!-- form check -->
              <div class="form-check mb-2">
                <!-- input -->
                <input class="form-check-input" type="checkbox" value="" id="ratingFour" checked>
                <label class="form-check-label" for="ratingFour">
                  <i class="bi bi-star-fill text-warning"></i>
                  <i class="bi bi-star-fill text-warning "></i>
                  <i class="bi bi-star-fill text-warning "></i>
                  <i class="bi bi-star-fill text-warning "></i>
                  <i class="bi bi-star text-warning"></i>
                </label>
              </div>
              <!-- form check -->
              <div class="form-check mb-2">
                <!-- input -->
                <input class="form-check-input" type="checkbox" value="" id="ratingThree">
                <label class="form-check-label" for="ratingThree">
                  <i class="bi bi-star-fill text-warning"></i>
                  <i class="bi bi-star-fill text-warning "></i>
                  <i class="bi bi-star-fill text-warning "></i>
                  <i class="bi bi-star text-warning"></i>
                  <i class="bi bi-star text-warning"></i>
                </label>
              </div>
              <!-- form check -->
              <div class="form-check mb-2">
                <!-- input -->
                <input class="form-check-input" type="checkbox" value="" id="ratingTwo">
                <label class="form-check-label" for="ratingTwo">
                  <i class="bi bi-star-fill text-warning"></i>
                  <i class="bi bi-star-fill text-warning"></i>
                  <i class="bi bi-star text-warning"></i>
                  <i class="bi bi-star text-warning"></i>
                  <i class="bi bi-star text-warning"></i>
                </label>
              </div>
              <!-- form check -->
              <div class="form-check mb-2">
                <!-- input -->
                <input class="form-check-input" type="checkbox" value="" id="ratingOne">
                <label class="form-check-label" for="ratingOne">
                  <i class="bi bi-star-fill text-warning"></i>
                  <i class="bi bi-star text-warning"></i>
                  <i class="bi bi-star text-warning"></i>
                  <i class="bi bi-star text-warning"></i>
                  <i class="bi bi-star text-warning"></i>
                </label>
              </div>
            </div>


          </div>*@
          @*<div class="mb-8 position-relative">
            <!-- Banner Design -->
            <!-- Banner Content -->
            <div class="position-absolute p-5 py-8">
              <h3 class="mb-0">Fresh Fruits </h3>
              <p>Get Upto 25% Off</p>
              <a href="#" class="btn btn-dark">Shop Now<i class="feather-icon icon-arrow-right ms-1"></i></a>
            </div>
            <!-- Banner Content -->
            <!-- Banner Image -->
            <!-- img --><img src="../assets/images/banner/assortment-citrus-fruits.png" alt=""
              class="img-fluid rounded ">
            <!-- Banner Image -->
          </div>*@
          </div>
        </div>
        </aside>
        <section class="col-lg-9 col-md-12">
          <!-- card -->
          <div class="card mb-4 bg-light border-0">
            <!-- card body -->
            <div class=" card-body p-9">
                            <h2 class="mb-0 fs-1">@(language == "az" ? categoryAz : categoryEn)</h2>
            </div>
          </div>
          <!-- list icon -->
          <div class="d-lg-flex justify-content-between align-items-center">
            <div class="mb-3 mb-lg-0">
              <p class="mb-0"> <span class="text-dark">@productCount </span> Products found </p>
            </div>

            <!-- icon -->
            @*<div class="d-md-flex justify-content-between align-items-center">
              <div class="d-flex align-items-center justify-content-between">
              
              <div class="ms-2 d-lg-none">
                <a class="btn btn-outline-gray-400 text-muted" data-bs-toggle="offcanvas" href="#offcanvasCategory" role="button" aria-controls="offcanvasCategory"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none"
                  stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                  class="feather feather-filter me-2">
                  <polygon points="22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"></polygon>
                </svg> Filters</a>
              </div>
            </div>

              <div class="d-flex mt-2 mt-lg-0">
                <div class="me-2 flex-grow-1">
                  <!-- select option -->
                  <select class="form-select">
                    <option selected>Show: 50</option>
                    <option value="10">10</option>
                    <option value="20">20</option>
                    <option value="30">30</option>
                  </select></div>
                <div>
                  <!-- select option -->
                  <select class="form-select">
                    <option selected>Sort by: Featured</option>
                    <option value="Low to High">Price: Low to High</option>
                    <option value="High to Low"> Price: High to Low</option>
                    <option value="Release Date"> Release Date</option>
                    <option value="Avg. Rating"> Avg. Rating</option>

                  </select></div>

              </div>

            </div>*@
          </div>
          <!-- row -->
          <div class="row g-4 row-cols-xl-4 row-cols-lg-3 row-cols-2 row-cols-md-2 mt-2">

            <!-- col -->
                        @foreach (Product product in Model)
                        {
                            <div class="col">
                                <!-- card -->
                                <div class="card card-product">
                                    <div class="card-body">

                                        <!-- badge -->
                                        <div class="text-center position-relative ">
                                            @*<div class=" position-absolute top-0 start-0">
                                                <span class="badge bg-danger">Sale</span>
                                            </div>*@
                                            <a asp-controller="product" asp-action="detail" asp-route-productId="@product.Id">
                                                <!-- img --><img src="~/uploads/products/@product.ProductImages.FirstOrDefault(x=>x.IsPoster==true).Image"
                                                             alt="Grocery Ecommerce Template" class="mb-3 img-fluid">
                                            </a>
                                            <!-- action btn -->

                                        </div>
                                        <!-- heading -->
                                        <div class="text-small mb-1">
                                            <a href="#!" class="text-decoration-none text-muted">
                                                <small>
                                                    @(language == "az" ? product.Category.NameAz : product.Category.NameEn)
                                                </small>
                                            </a>
                                        </div>
                                        <h2 class="fs-6">
                                            <a asp-controller="product" asp-action="detail" asp-route-productId="@product.Id" class="text-inherit text-decoration-none">
                                           @product.Name
                                         </a></h2>
                                        @*<div>
                                    <!-- rating -->
                                    <small class="text-warning"> <i class="bi bi-star-fill"></i>
                                    <i class="bi bi-star-fill"></i>
                                    <i class="bi bi-star-fill"></i>
                                    <i class="bi bi-star-fill"></i>
                                    <i class="bi bi-star-half"></i></small> <span class="text-muted small">4.5(149)</span>
                                    </div>*@
                                        <!-- price -->
                                        <div class="d-flex justify-content-between align-items-center mt-3">
                                            <div>
                                                @if (product.DiscountPercentage > 0)
                                                {
                                                    <span class="text-dark">@((product.SalePrice * (1 - product.DiscountPercentage / 100)).ToString("0.00"))</span>
                                                }
                                                <span class="@(product.DiscountPercentage>0 ? "text-decoration-line-through text-muted" : "text-dark") ">$@(product.SalePrice)</span>
                                            </div>
                                            <!-- btn -->
                                            <div>
                                                <a asp-controller ="product" asp-action="addtobasket" asp-route-productId="@product.Id" class="btn btn-primary btn-sm add-to-basket-btn">
                                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none"
                                                     stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                                                     class="feather feather-plus">
                                                        <line x1="12" y1="5" x2="12" y2="19"></line>
                                                        <line x1="5" y1="12" x2="19" y2="12"></line>
                                                    </svg> Add
                                                </a>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        }
          </div>
          <div class="row mt-8">
            <div class="col">
                     <!-- nav -->
                          <nav>
                                <ul class="pagination">
                                    @if (Model.HasPrevious)
                                    {
                                        <li class="page-item disabled">
                                            <a class="page-link mx-1 "
                                           asp-controller="home" asp-action="searchproducts" 
                                           asp-route-page="@(Model.Page-1)"
                                           aria-label="Previous">
                                                <i class="feather-icon icon-chevron-left"></i>
                                            </a>
                                        </li>
                                    }
                                    @for (int i = 1; i <= Model.TotalPage; i++)
                                    {
                                        <li class="page-item">
                                            <a class="page-link mx-1 active" asp-controller="home" asp-action="searchproducts"
                                            asp-route-page="@i">
                                                @i
                                            </a>
                                        </li>
                                    }
                                    @if (Model.HasNext)
                                    {
                                        <li class="page-item">
                                            <a class="page-link mx-1 text-body"
                                           asp-controller="home" asp-action="searchproducts" asp-route-page="@(Model.Page+1)"
                                           aria-label="Next">
                                                <i class="feather-icon icon-chevron-right"></i>
                                            </a>
                                        </li>
                                    }
                                </ul>
                            </nav>
            </div>
          </div>
        </section>
      </div>
    </div>
  </div>
</main>